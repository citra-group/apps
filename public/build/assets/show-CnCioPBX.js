import{_ as M,b as V,w as a,e as t,j as b,i as e,t as s,N as D,V as v,g as i,p as d,l as m,$ as T,f as _,a0 as G,F as C,k as F,G as z,E as $,W as B,m as p,n as P,d as I,R as H,D as y,z as x,I as S,P as O,Q as N,h as R,o as r}from"./App-Da-KJahm.js";import{V as K,a as W}from"./VSlider-B0zICkDt.js";import{V as Y,a as j}from"./VRadioGroup-B07FHX9q.js";import{V as J}from"./VTextarea-D2DFl51m.js";const Q={name:"coperative-loan-show",data:()=>({sheet:!1,toggle:null,dialogEdit:!1,dialogMessage:!1,menuTransferDate:!1,formatter:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0})}),methods:{calculateLoanGrandTotal(n){n.total_principal=Math.round(n.total_principal*100)/100,n.percent_approval=Math.round(n.approval_interest/n.tenor*100)/100,n.total_interest=Math.round(n.total_principal*(n.approval_interest/100)*100)/100,n.monthly_interest=Math.round((n.total_principal/n.tenor+n.total_interest/n.tenor)*100)/100,n.grandtotal=n.total_principal+n.admfee+n.total_interest},dateFormated(n){if(!n)return null;const[l,E,U]=n.split("-");return`${U}-${E}-${l}`},openDialogMessage(){this.dialogMessage=!0},rejectedCurrentLoan(n,l){if(!n.rejected_message){l.$snackbar({text:"Berikan alasan penolakan pinjaman."});return}l.$http(`coperative/api/loan/${n.id}/rejected`,{method:"POST",params:n}).then(()=>{l.snackbar.color="green",l.snackbar.text="Berhasil ditolak",l.snackbar.state=!0,this.$router.push({name:"coperative-loan"})})},verifiedCurrentLoan(n,l){l.$http(`coperative/api/loan/${n.id}/verified`,{method:"POST",params:n}).then(()=>{l.snackbar.color="green",l.snackbar.text="Berhasil diverifikasi",l.snackbar.state=!0,this.$router.push({name:"coperative-loan"})})},approveCurrentLoan(n,l){l.$http(`coperative/api/loan/${n.id}/approve`,{method:"POST",params:n}).then(()=>{this.$router.push({name:"coperative-loan"})})},updateLoanPayDate(n,l){l.$http(`coperative/api/loan/${n.id}/paydate`,{method:"POST",params:n}).then(()=>{l.snackbar.color="green",l.snackbar.text="Berhasil",l.snackbar.state=!0,this.$router.push({name:"coperative-loan"})})},updateStatusOfLoan(n,l){l.$http(`coperative/api/loan/${n.id}/close-by-bank`,{method:"POST",params:n,contentType:"multipart/form-data"}).then(()=>{l.snackbar.color="green",l.snackbar.text="Berhasil",l.snackbar.state=!0,this.$router.push({name:"coperative-loan"})})},downloadReceiptOfMoney(n,l){l.$http(`coperative/api/loan/${n.id}/download-receipt`,{method:"POST",params:n}).then(()=>{this.$router.push({name:"coperative-loan"})})}}},q={class:"text-caption pr-1 pl-2"},X={class:"text-h5"},Z={class:"text-h5"},h={class:"d-flex"},c={class:"d-flex align-center"},ll={class:"text-h6"},tl={class:"px-4 py-2 d-flex justify-end"},al={class:"text-right"},el={class:"text-h5"},nl={key:0},ol={key:1},ul={class:"text-h5"};function sl(n,l,E,U,dl,k){const L=I("v-date-input"),w=I("form-show");return r(),V(w,{"with-helpdesk":"","hide-edit":"","hide-delete":""},{toolbar:a(({record:o,store:g})=>[o.status==="ONGOING"?(r(),V(p,{key:0,class:"ma-2",icon:"",tooltip:"Cetak Kuitansi",onClick:f=>k.downloadReceiptOfMoney(o,g)},{default:a(()=>[t(P,null,{default:a(()=>l[9]||(l[9]=[d("print")])),_:1,__:[9]})]),_:2},1032,["onClick"])):_("",!0)]),default:a(({record:o,store:g,theme:f})=>[t(D,{color:f,class:"position-absolute d-flex pa-1",rounded:"pill",style:{top:"8px",right:"8px"}},{default:a(()=>[l[10]||(l[10]=e("div",{class:"text-caption bg-white rounded-pill px-2"},"STS",-1)),e("div",q,s(o.status),1)]),_:2,__:[10]},1032,["color"]),t(m,null,{default:a(()=>[t(v,{dense:""},{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[e("div",X,[l[11]||(l[11]=d(" Nominal Pinjaman: ")),e("div",null,s(n.formatter.format(o.total_principal)),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(T,{class:"overline"},{default:a(()=>l[12]||(l[12]=[d("Tenor")])),_:1,__:[12]}),t(m,{class:"pt-0"},{default:a(()=>[t(v,{dense:""},{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[e("div",Z,s(o.tenor)+"x",1)]),_:2},1024),o.status==="VERIFIED"?(r(),V(i,{key:0,cols:"12"},{default:a(()=>[t(K,{max:o.loan_tenor_maximal,min:o.loan_tenor_minimal,step:1,modelValue:o.tenor,"onUpdate:modelValue":u=>o.tenor=u,onChange:u=>k.calculateLoanGrandTotal(o,g),readonly:"","hide-details":""},null,8,["max","min","modelValue","onUpdate:modelValue","onChange"])]),_:2},1024)):_("",!0)]),_:2},1024)]),_:2},1024),["ONGOING","COMPLETED"].includes(o.status)?(r(),b(C,{key:0},[t(m,null,{default:a(()=>[t(G,{class:"overline"},{default:a(()=>l[13]||(l[13]=[d("Detail Pinjaman")])),_:1,__:[13]})]),_:1}),(r(!0),b(C,null,F(o.details,(u,A)=>(r(),V(y,{rounded:"lg",class:"mb-4 mx-2",key:A,flat:"",border:""},{default:a(()=>[t(m,{class:"d-flex pb-0"},{default:a(()=>[t(i,{cols:"6"},{default:a(()=>[d(s(u.slug),1)]),_:2},1024),t(i,null,{default:a(()=>[l[14]||(l[14]=e("small",null,"Tenor:",-1)),e("small",null,s(u.tenor)+"/"+s(u.tenor_total),1)]),_:2,__:[14]},1024),t(i,null,{default:a(()=>[l[15]||(l[15]=e("small",null,"Status:",-1)),t(P,{color:u.paid?"green":"grey"},{default:a(()=>[d(s(u.paid?"check_circle":"radio_button_unchecked"),1)]),_:2},1032,["color"])]),_:2,__:[15]},1024)]),_:2},1024),t(m,{class:"bg-grey-lighten-5"},{default:a(()=>[e("div",h,[t(i,null,{default:a(()=>[l[16]||(l[16]=e("small",null,"Jatuh Tempo",-1)),e("div",null,[e("small",null,s(u.duedate),1)])]),_:2,__:[16]},1024),t(i,null,{default:a(()=>[l[17]||(l[17]=e("small",null,"Pokok",-1)),e("div",null,s(n.formatter.format(u.principal)),1)]),_:2,__:[17]},1024),t(i,null,{default:a(()=>[l[18]||(l[18]=e("small",null,"Bunga",-1)),e("div",null,s(n.formatter.format(u.interest)),1)]),_:2,__:[18]},1024),t(i,null,{default:a(()=>[l[19]||(l[19]=e("small",null,"Total",-1)),e("div",null,[e("small",null,s(n.formatter.format(u.grandtotal)),1)])]),_:2,__:[19]},1024)])]),_:2},1024)]),_:2},1024))),128))],64)):(r(),b(C,{key:1},[t(T,{class:"overline"},{default:a(()=>l[20]||(l[20]=[d("Pinjaman")])),_:1,__:[20]}),t(T,{class:"overline"},{default:a(()=>l[21]||(l[21]=[d("metode pembayaran")])),_:1,__:[21]}),t(m,{class:"pt-0"},{default:a(()=>[t(v,{dense:""},{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[t(Y,{modelValue:o.transfermode,"onUpdate:modelValue":u=>o.transfermode=u,disabled:o.status!=="APPROVED","hide-details":"",readonly:"",row:""},{default:a(()=>[t(j,{label:"CASH",value:1}),t(j,{label:"BANK",value:2}),t(j,{label:"PAYMENT-GATEWAY",value:3})]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1024),o.transfermode===2?(r(),b(C,{key:0},[t(i,{cols:"4"},{default:a(()=>[t(z,{variant:"outlined",items:["BRI","BCA","BNI","BTPN","MANDIRI"],label:"Bank",color:f,modelValue:o.bank_type,"onUpdate:modelValue":u=>o.bank_type=u,readonly:"","hide-details":""},null,8,["color","modelValue","onUpdate:modelValue"])]),_:2},1024),t(i,{cols:"8"},{default:a(()=>[t($,{variant:"outlined",color:f,label:"Atas Nama",modelValue:o.bank_account_name,"onUpdate:modelValue":u=>o.bank_account_name=u,readonly:"","hide-details":""},null,8,["color","modelValue","onUpdate:modelValue"])]),_:2},1024),t(i,{cols:"12"},{default:a(()=>[t($,{variant:"outlined",color:f,label:"Nomor Rekening",modelValue:o.bank_account_number,"onUpdate:modelValue":u=>o.bank_account_number=u,readonly:""},null,8,["color","modelValue","onUpdate:modelValue"])]),_:2},1024)],64)):_("",!0)]),_:2},1024)]),_:2},1024),["APPROVED","ONGOING"].includes(o.status)?(r(),V(D,{key:0},{default:a(()=>[t(m,null,{default:a(()=>[t(B),o.status==="APPROVED"&&o.transfermode===1?(r(),V(p,{key:0,block:"",color:f,onClick:u=>k.updateLoanPayDate(o,g)},{default:a(()=>[t(P,null,{default:a(()=>l[22]||(l[22]=[d("save")])),_:1,__:[22]}),l[23]||(l[23]=d(" Pay-Cash"))]),_:2,__:[23]},1032,["color","onClick"])):_("",!0)]),_:2},1024)]),_:2},1024)):_("",!0),t(m,{class:"pt-0"},{default:a(()=>[o.status==="APPROVED"&&o.transfermode===2?(r(),V(v,{key:0,dense:""},{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[t(L,{color:f,variant:"outlined",modelValue:o.transferdate,"onUpdate:modelValue":u=>o.transferdate=u,label:"Tanggal Transfer","prepend-icon":"","prepend-inner-icon":"$calendar"},null,8,["color","modelValue","onUpdate:modelValue"])]),_:2},1024),t(i,{cols:"12"},{default:a(()=>[t(H,{color:f,variant:"outlined",accept:"image/*",label:"Upload Bukti Transfer",modelValue:o.image_path,"onUpdate:modelValue":u=>o.image_path=u,"prepend-icon":"","prepend-inner-icon":"attach_file","hide-details":""},null,8,["color","modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)):_("",!0)]),_:2},1024)],64)),t(N,{modelValue:n.dialogMessage,"onUpdate:modelValue":l[1]||(l[1]=u=>n.dialogMessage=u),width:"500"},{default:a(()=>[t(y,null,{default:a(()=>[t(x,{class:"text-h5 grey lighten-2"},{default:a(()=>l[24]||(l[24]=[d("Alasan Penolakan")])),_:1,__:[24]}),t(m,null,{default:a(()=>[t(v,null,{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[t(J,{modelValue:o.rejected_message,"onUpdate:modelValue":u=>o.rejected_message=u},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(S),t(O,null,{default:a(()=>[t(B),t(p,{color:"grey",text:"",onClick:l[0]||(l[0]=u=>n.dialogMessage=!1)},{default:a(()=>l[25]||(l[25]=[d(" Batal ")])),_:1,__:[25]}),t(p,{color:"primary",text:"",onClick:u=>k.rejectedCurrentLoan(o,g)},{default:a(()=>l[26]||(l[26]=[d(" Simpan ")])),_:2,__:[26]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"]),t(y,{class:"position-sticky bottom-0 mx-4 px-2",flat:"",color:`${f}-lighten-5`},{default:a(()=>[e("div",c,[l[28]||(l[28]=e("small",null,"Detail Pinjaman",-1)),t(p,{icon:"",onClick:l[2]||(l[2]=u=>n.sheet=!n.sheet),variant:"text",size:"small"},{default:a(()=>[t(P,null,{default:a(()=>l[27]||(l[27]=[d("arrow_drop_up")])),_:1,__:[27]})]),_:1})]),t(v,{"no-gutters":"",class:"d-flex"},{default:a(()=>[t(i,null,{default:a(()=>[e("div",ll,s(n.formatter.format(o.monthly_interest)),1)]),_:2},1024),t(i,null,{default:a(()=>[e("div",tl,[["PUBLISH","VERIFIED"].includes(o.status)?(r(),V(p,{key:0,variant:"flat",size:"small",color:"red",onClick:l[3]||(l[3]=u=>n.dialogMessage=!0)},{default:a(()=>l[29]||(l[29]=[d("Tolak")])),_:1,__:[29]})):_("",!0),o.status==="PUBLISH"?(r(),V(p,{key:1,variant:"flat",class:"ml-2",size:"small",color:f,onClick:u=>k.verifiedCurrentLoan(o,g)},{default:a(()=>l[30]||(l[30]=[d("Verifikasi")])),_:2,__:[30]},1032,["color","onClick"])):_("",!0),o.status==="VERIFIED"?(r(),V(p,{key:2,variant:"flat",size:"small",class:"ml-1",color:f,onClick:u=>k.approveCurrentLoan(o,g)},{default:a(()=>l[31]||(l[31]=[d("Setujui")])),_:2,__:[31]},1032,["color","onClick"])):_("",!0),o.status==="APPROVED"&&o.transfermode===2?(r(),V(p,{key:3,variant:"flat",size:"small",color:f,disabled:o.transferdate===null,onClick:u=>k.updateStatusOfLoan(o,g)},{default:a(()=>l[32]||(l[32]=[d("Selesai")])),_:2,__:[32]},1032,["color","disabled","onClick"])):_("",!0)])]),_:2},1024)]),_:2},1024),l[65]||(l[65]=e("div",{class:"px-4 py-2 align-center"},null,-1)),t(W,{modelValue:n.sheet,"onUpdate:modelValue":l[8]||(l[8]=u=>n.sheet=u),inset:n.$vuetify.display.width>=600},{default:a(()=>[t(y,{style:{"border-top-left-radius":"25px","border-top-right-radius":"25px"}},{default:a(()=>[t(m,null,{default:a(()=>[e("div",al,[t(p,{icon:"",color:"red",variant:"tonal",onClick:l[4]||(l[4]=u=>n.sheet=!n.sheet)},{default:a(()=>[t(P,null,{default:a(()=>l[33]||(l[33]=[d("close")])),_:1,__:[33]})]),_:1})]),l[54]||(l[54]=e("br",null,null,-1)),l[55]||(l[55]=e("br",null,null,-1)),t(y,{flat:"",color:`${f}-lighten-5`},{default:a(()=>[t(m,null,{default:a(()=>[l[35]||(l[35]=e("div",null,[e("small",null,"Angsuran / Bulan")],-1)),e("div",el,[d(s(n.formatter.format(o.monthly_interest)),1),l[34]||(l[34]=e("small",null,"/ Bulan",-1))])]),_:2,__:[35]},1024)]),_:2},1032,["color"]),t(v,null,{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[t(R,{density:""},{default:a(()=>[e("tbody",null,[e("tr",null,[l[36]||(l[36]=e("td",null," Total Pokok Pinjaman ",-1)),l[37]||(l[37]=e("td",null,":",-1)),e("td",null,s(n.formatter.format(o.total_principal)),1),l[38]||(l[38]=e("td",null," ",-1))]),e("tr",null,[l[43]||(l[43]=e("td",null,"Total Bunga [%]",-1)),l[44]||(l[44]=e("td",null,":",-1)),e("td",null,s(o.approval_interest)+" of "+s(o.percent_interest)+"% ",1),o.status==="VERIFIED"?(r(),b("td",nl,[t(p,{color:"orange",icon:"",size:"small",variant:"tonal",onClick:l[5]||(l[5]=u=>n.dialogEdit=!0)},{default:a(()=>[t(P,{small:""},{default:a(()=>l[39]||(l[39]=[d("edit")])),_:1,__:[39]})]),_:1}),t(N,{modelValue:n.dialogEdit,"onUpdate:modelValue":l[7]||(l[7]=u=>n.dialogEdit=u),width:"500"},{default:a(()=>[t(y,null,{default:a(()=>[t(x,{class:"text-h5 grey lighten-2"},{default:a(()=>l[40]||(l[40]=[d("Edit Bunga Pinjaman")])),_:1,__:[40]}),t(m,{class:"pt-4"},{default:a(()=>[t(v,{dense:""},{default:a(()=>[t(i,{cols:"6"},{default:a(()=>[t($,{label:"Pengajuan Bunga Pinjaman",modelValue:o.percent_interest,"onUpdate:modelValue":u=>o.percent_interest=u,suffix:"%","hide-details":"",readonly:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(i,{cols:"6"},{default:a(()=>[t($,{label:"Persetujuan Bunga Pinjaman",modelValue:o.approval_interest,"onUpdate:modelValue":u=>o.approval_interest=u,suffix:"%","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024),t(S),t(O,null,{default:a(()=>[t(B),t(p,{text:"",onClick:l[6]||(l[6]=u=>n.dialogEdit=!1)},{default:a(()=>l[41]||(l[41]=[d(" Batal ")])),_:1,__:[41]}),t(p,{color:"primary",text:"",onClick:u=>{n.dialogEdit=!1,k.calculateLoanGrandTotal(o)}},{default:a(()=>l[42]||(l[42]=[d(" Simpan ")])),_:2,__:[42]},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])])):(r(),b("td",ol," "))]),e("tr",null,[l[45]||(l[45]=e("td",null,"Total Bunga [Rp]",-1)),l[46]||(l[46]=e("td",null,":",-1)),e("td",null,s(n.formatter.format(o.total_interest)),1),l[47]||(l[47]=e("td",null," ",-1))]),e("tr",null,[l[48]||(l[48]=e("td",null,"Admin Fee",-1)),l[49]||(l[49]=e("td",null,":",-1)),e("td",null,s(n.formatter.format(o.admfee)),1),l[50]||(l[50]=e("td",null," ",-1))]),e("tr",null,[l[51]||(l[51]=e("td",null,"Grand Total",-1)),l[52]||(l[52]=e("td",null,":",-1)),e("td",null,s(n.formatter.format(o.grandtotal)),1),l[53]||(l[53]=e("td",null," ",-1))])])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2,__:[54,55]},1024),t(S),t(m,null,{default:a(()=>[t(y,{flat:"",color:`${f}-lighten-5`},{default:a(()=>[t(m,null,{default:a(()=>[l[56]||(l[56]=e("small",null,"Pinjaman Berjalan",-1)),e("div",ul,s(n.formatter.format(o.current_of_loan)),1)]),_:2,__:[56]},1024)]),_:2},1032,["color"]),t(v,{dense:""},{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[t(R,{density:""},{default:a(()=>[e("tbody",null,[e("tr",null,[l[57]||(l[57]=e("td",null,"Maximal Pinjaman",-1)),l[58]||(l[58]=e("td",null,":",-1)),e("td",null,s(n.formatter.format(o.amount_of_maxloan)),1)]),e("tr",null,[l[59]||(l[59]=e("td",null,"Limit Pinjaman",-1)),l[60]||(l[60]=e("td",null,":",-1)),e("td",null,s(n.formatter.format(o.limit_of_maxloan)),1)]),e("tr",null,[l[61]||(l[61]=e("td",null,"Total Pinjaman",-1)),l[62]||(l[62]=e("td",null,":",-1)),e("td",null,s(n.formatter.format(o.total_of_loan)),1)]),e("tr",null,[l[63]||(l[63]=e("td",null,"Sisa Pinjaman",-1)),l[64]||(l[64]=e("td",null,":",-1)),e("td",null,s(n.formatter.format(o.current_of_loan)),1)])])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue","inset"])]),_:2,__:[65]},1032,["color"]),t(m)]),_:1})}const pl=M(Q,[["render",sl]]);export{pl as default};
