import{_ as U,b,w as e,e as t,j as T,f as k,i as a,t as u,N as D,bG as E,m as V,l as m,I,V as v,g as d,p,F as x,k as L,h as O,a0 as S,G as c,E as R,D as B,n as $,d as F,o as i,J as P}from"./App-Y1uS_7oZ.js";import{V as G,a as N}from"./VRadioGroup-CbjyGREB.js";const j={name:"mycoperative-loan-show",data:()=>({formatter:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0})}),computed:{unpaidCount(){return this.record.details.filter(o=>!o.paid).length}},methods:{publishThisLoan(o,l){l.$http(`mycoperative/api/loan/${o.id}/publish`,{method:"POST",params:o}).then(y=>{let g=l.records.findIndex(f=>f.id===o.id);l.records[g].status=y.status,l.snackbar.color="green",l.snackbar.text="Berhasil",l.snackbar.state=!0,this.$router.push({name:"mycoperative-loan"})})},closeThisLoan(o,l){l.$http(`mycoperative/api/loan/${o.id}/close-by-cash`,{method:"POST",params:o,contentType:"multipart/form-data"}).then(()=>{l.snackbar.color="green",l.snackbar.text="Berhasil",l.snackbar.state=!0,this.$router.push({name:"mycoperative-loan"})}).catch(y=>{console.error("Error:",y.message)})},downloadReceiptOfTransaction(o,l){l.$http(`mycoperative/api/receipt/${o.slug}`,{method:"GET",responseType:"blob"}).then(y=>{const g=new Blob([y],{type:"application/pdf"}),f=document.createElement("a");f.href=URL.createObjectURL(g),f.download=o.slug+".pdf",f.click(),URL.revokeObjectURL(f.href),l.loader.state=!1}).catch(()=>{})}}},h={class:"text-caption pr-1 pl-2"},J={key:0,class:"text-end ma-2"},M={class:"text-h5"},H={class:"text-h5"},z={class:"d-flex align-center"},K={class:"px-4 py-2 flex-grow-1"},Y={class:"text-h5"},q={class:"px-4 py-2"};function Q(o,l,y,g,f,C){const A=F("form-show");return i(),b(A,{"with-helpdesk":"",ref:"form","hide-delete":"","hide-edit":""},{toolbar:e(({record:n,store:_})=>[n.status==="DRAFT"?(i(),b(V,{key:0,icon:"edit",onClick:l[0]||(l[0]=r=>o.$refs.form.openFormEdit())})):k("",!0),n.status==="DRAFT"?(i(),b(V,{key:1,icon:"delete",onClick:l[1]||(l[1]=r=>o.$refs.form.postFormDelete())})):k("",!0),n.status==="ONGOING"?(i(),b(V,{key:2,icon:"",tooltip:"Cetak Tanda Terima",onClick:r=>C.downloadReceiptOfTransaction(n,_)},{default:e(()=>[t($,null,{default:e(()=>l[2]||(l[2]=[p("print")])),_:1})]),_:2},1032,["onClick"])):k("",!0)]),default:e(({record:n,store:_,theme:r})=>[t(D,{color:r,class:"position-absolute d-flex pa-1",rounded:"pill",style:{top:"8px",right:"8px"}},{default:e(()=>[l[3]||(l[3]=a("div",{class:"text-caption bg-white rounded-pill px-2"},"STS",-1)),a("div",h,u(n.status),1)]),_:2},1032,["color"]),n.status==="REJECTED"?(i(),T("div",J,[a("small",null,"!"+u(n.rejected_message),1)])):k("",!0),t(m,null,{default:e(()=>[t(E,{modelValue:n.type,"onUpdate:modelValue":s=>n.type=s,divided:"",color:`${r}-darken-1`},{default:e(()=>[t(V,{icon:"person",value:"personal",disabled:""}),t(V,{icon:"apartment",value:"unit",disabled:""})]),_:2},1032,["modelValue","onUpdate:modelValue","color"])]),_:2},1024),t(I),t(m,null,{default:e(()=>[t(v,{dense:""},{default:e(()=>[t(d,{cols:"12"},{default:e(()=>[l[4]||(l[4]=a("div",null,[a("small",null,"Nominal Pinjaman:")],-1)),a("div",M,u(o.formatter.format(n.total_principal)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(m,{class:"pt-0"},{default:e(()=>[t(v,{dense:""},{default:e(()=>[t(d,{cols:"12"},{default:e(()=>[l[5]||(l[5]=p("Tenor ")),a("div",H,u(n.tenor)+"x",1)]),_:2},1024),t(d,{cols:"12"},{default:e(()=>[a("div",null,"Sisa Tagihann "+u(n.countUnpaid)+"x",1)]),_:2},1024)]),_:2},1024)]),_:2},1024),["ONGOING","COMPLETED"].includes(n.status)?(i(),T(x,{key:1},[t(m,null,{default:e(()=>[t(v,null,{default:e(()=>[t(d,{cols:"6"},{default:e(()=>l[6]||(l[6]=[p("Detail Pinjamanan")])),_:1})]),_:1})]),_:1}),(i(!0),T(x,null,L(n.details,(s,w)=>(i(),b(B,{rounded:"lg",class:"mb-4 mx-2",key:w,flat:"",border:""},{default:e(()=>[t(m,{class:"d-flex pb-0"},{default:e(()=>[t(d,{cols:"6"},{default:e(()=>[p(u(s.slug),1)]),_:2},1024),t(d,null,{default:e(()=>[l[7]||(l[7]=a("small",null,"Tenor:",-1)),a("small",null,u(s.tenor)+"/"+u(s.tenor_total),1)]),_:2},1024),t(d,null,{default:e(()=>[l[8]||(l[8]=a("small",null,"Status:",-1)),t($,{color:s.paid?"green":"grey"},{default:e(()=>[p(u(s.paid?"check_circle":"radio_button_unchecked"),1)]),_:2},1032,["color"])]),_:2},1024)]),_:2},1024),t(m,{class:P(`bg-${r}-lighten-5`)},{default:e(()=>[t(v,{class:"d-flex"},{default:e(()=>[t(d,null,{default:e(()=>[l[9]||(l[9]=a("small",null,"Jatuh Tempo",-1)),a("div",null,[a("small",null,u(s.duedate),1)])]),_:2},1024),t(d,null,{default:e(()=>[l[10]||(l[10]=a("small",null,"Pokok",-1)),a("div",null,u(o.formatter.format(s.principal)),1)]),_:2},1024),t(d,null,{default:e(()=>[l[11]||(l[11]=a("small",null,"Bunga",-1)),a("div",null,u(o.formatter.format(s.interest)),1)]),_:2},1024),t(d,null,{default:e(()=>[l[12]||(l[12]=a("small",null,"Total",-1)),a("div",null,[a("small",null,u(o.formatter.format(s.grandtotal)),1)])]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024))),128))],64)):(i(),T(x,{key:2},[t(m,{class:"pt-0"},{default:e(()=>[t(v,{dense:""},{default:e(()=>[t(d,{cols:"12"},{default:e(()=>[t(O,null,{default:e(()=>[a("tbody",null,[a("tr",null,[l[13]||(l[13]=a("td",null,"Total Pokok Pinjaman",-1)),l[14]||(l[14]=a("td",null,":",-1)),a("td",null,u(o.formatter.format(n.total_principal)),1)]),a("tr",null,[l[15]||(l[15]=a("td",null,"Total Bunga [%]",-1)),l[16]||(l[16]=a("td",null,":",-1)),a("td",null,u(n.percent_interest)+"% ",1)]),a("tr",null,[l[17]||(l[17]=a("td",null,"Total Bunga [Rp]",-1)),l[18]||(l[18]=a("td",null,":",-1)),a("td",null,u(o.formatter.format(n.total_interest)),1)]),a("tr",null,[l[19]||(l[19]=a("td",null,"Admin Fee",-1)),l[20]||(l[20]=a("td",null,":",-1)),a("td",null,u(o.formatter.format(n.admfee)),1)]),a("tr",null,[l[21]||(l[21]=a("td",null,"Grand Total",-1)),l[22]||(l[22]=a("td",null,":",-1)),a("td",null,u(n.grandtotal),1)])])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(m,null,{default:e(()=>[t(S,{class:"overline"},{default:e(()=>l[23]||(l[23]=[p("metode pembayaran")])),_:1})]),_:1}),t(m,{class:"pt-0"},{default:e(()=>[t(v,{dense:""},{default:e(()=>[t(d,{cols:"12"},{default:e(()=>[t(G,{modelValue:n.transfermode,"onUpdate:modelValue":s=>n.transfermode=s,disabled:"","hide-details":"",row:""},{default:e(()=>[t(N,{label:"CASH",value:1}),t(N,{label:"BANK",value:2})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),n.transfermode==1&&n.status==="APPROVED"?(i(),b(V,{key:0,disabled:!n.paydate>0,class:"mt-6",color:"green",block:"",dark:"",depressed:"",onClick:s=>C.closeThisLoan(n,_)},{default:e(()=>l[24]||(l[24]=[p("UANG TELAH SAYA TERIMA")])),_:2},1032,["disabled","onClick"])):k("",!0),n.transfermode===2?(i(),T(x,{key:1},[t(d,{cols:"4"},{default:e(()=>[t(c,{color:r,items:["BRI","BCA","BNI","BTPN","MANDIRI"],label:"Bank",modelValue:n.bank_type,"onUpdate:modelValue":s=>n.bank_type=s,readonly:"",variant:"outlined","hide-details":""},null,8,["color","modelValue","onUpdate:modelValue"])]),_:2},1024),t(d,{cols:"8"},{default:e(()=>[t(R,{color:r,label:"Atas Nama",modelValue:n.bank_account_name,"onUpdate:modelValue":s=>n.bank_account_name=s,variant:"outlined",readonly:"","hide-details":""},null,8,["color","modelValue","onUpdate:modelValue"])]),_:2},1024),t(d,{cols:"12"},{default:e(()=>[t(R,{color:r,label:"Nomor Rekening",modelValue:n.bank_account_number,"onUpdate:modelValue":s=>n.bank_account_number=s,variant:"outlined",readonly:"","hide-details":""},null,8,["color","modelValue","onUpdate:modelValue"])]),_:2},1024)],64)):k("",!0)]),_:2},1024)]),_:2},1024),t(B,{class:"position-sticky bottom-0 mx-4",flat:"",color:`${r}-lighten-5`},{default:e(()=>[a("div",z,[a("div",K,[l[25]||(l[25]=a("small",null,"Angsungran / Bulan",-1)),a("div",Y,u(o.formatter.format(n.monthly_interest)),1)]),a("div",q,[n.status==="DRAFT"?(i(),b(V,{key:0,variant:"flat",color:r,class:"mt-2",onClick:s=>C.publishThisLoan(n,_)},{default:e(()=>l[26]||(l[26]=[p("Ajukan")])),_:2},1032,["color","onClick"])):k("",!0)])])]),_:2},1032,["color"]),t(m)],64))]),_:1},512)}const Z=U(j,[["render",Q]]);export{Z as default};
